<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fantasy Politics — Scoreboard</title>
<style>
  :root{--nav-h:68px;--sidebar-w:300px;--content-max:1320px;--gutter:20px;--gap:20px;--radius:14px;--panel:#171a2b;--panel-2:#1d2140;--text:#e7e9f4;--muted:#9aa1bd;--accent:#6ea8fe;--border:1px solid rgba(255,255,255,.06);--shadow:0 8px 24px rgba(0,0,0,.25);--control-h:36px}
  *,*:before,*:after{box-sizing:border-box}html,body{height:100%}
  body{margin:0;color:var(--text);background:linear-gradient(180deg,#0b0e1a,#0f1220);font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{color:inherit;text-decoration:none}
  .topnav{position:fixed;inset:0 0 auto;height:var(--nav-h);background:rgba(16,19,36,.9);backdrop-filter:blur(10px);border-bottom:var(--border);z-index:2000}
  .topnav__inner{height:100%;max-width:calc(var(--content-max)+var(--sidebar-w)+2*var(--gutter));margin:0 auto;display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:var(--gap);padding:0 var(--gutter)}
  .brand{justify-self:center;font-weight:800;letter-spacing:.3px}.brand span{color:var(--accent)}
  .nav-actions{justify-self:end;display:flex;gap:10px}
  .btn{background:var(--panel-2);border:var(--border);color:var(--text);border-radius:12px;padding:8px 12px;height:var(--control-h);box-shadow:var(--shadow);cursor:pointer}
  .app{padding-top:var(--nav-h);min-height:100vh}
  .frame{display:grid;grid-template-columns:var(--sidebar-w) minmax(0,1fr);gap:var(--gap);padding:var(--gutter);max-width:calc(var(--content-max)+var(--sidebar-w)+2*var(--gutter));margin:0 auto}
  .sidebar{background:var(--panel);border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);display:grid;grid-template-rows:auto 1fr;min-height:calc(100vh - var(--nav-h) - 2*var(--gutter))}
  .sidebar__header{padding:14px;border-bottom:var(--border);display:flex;align-items:center;justify-content:space-between}
  .sidebar__scroll{overflow:auto;padding:12px;display:grid;gap:12px;grid-auto-rows:min-content}
  .chip{display:inline-flex;align-items:center;justify-content:center;height:var(--control-h);background:var(--panel-2);border:var(--border);border-radius:999px;padding:0 10px;font-size:12px;color:var(--muted)}
  .team-tile{background:#1a1f3a;border:var(--border);border-radius:12px;padding:16px;display:grid;grid-template-columns:40px 1fr auto;gap:12px;align-items:center}
  .avatar{width:40px;height:40px;border-radius:50%;background:#2a2f52;display:grid;place-items:center;font-weight:800}
  .score-badge{background:#0e5b2c;color:#d4ffe6;padding:6px 10px;border-radius:999px;font-weight:800;font-size:12px}
  .main{background:var(--panel);border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);min-width:0;display:grid;grid-template-rows:auto 1fr;min-height:calc(100vh - var(--nav-h) - 2*var(--gutter))}
  .main__toolbar{padding:14px;border-bottom:var(--border);display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .toolbar-group{display:inline-flex;align-items:center;gap:8px;background:var(--panel-2);border:var(--border);border-radius:10px;padding:6px 8px}
  .label{color:var(--muted);font-size:12px}
  .segmented{display:inline-flex;border-radius:8px;overflow:hidden;border:var(--border)}
  .segmented button{background:transparent;border:0;color:var(--text);padding:0 12px;height:var(--control-h);cursor:pointer}
  .segmented .active{background:#243055}
  .segmented .disabled{opacity:.45;cursor:not-allowed}
  .notice{margin:10px 0 0;background:#1a2144;border:var(--border);border-radius:10px;padding:8px 10px;color:var(--muted);font-size:13px}
  .main__scroll{overflow:auto;padding:16px}
  .section{background:#151934;border:var(--border);border-radius:12px;padding:16px;margin-bottom:16px}
  .h1{font-size:22px;font-weight:800;margin:0 0 8px}
  .muted{color:var(--muted)}
  .scorebox{height:220px;background:#10152c;border:var(--border);border-radius:12px;display:grid;place-items:center;text-align:center}
  .scorebox .big{font-size:56px;font-weight:900;letter-spacing:.5px}
  .accordion{display:grid;gap:8px}
  .roll{background:#111634;border:var(--border);border-radius:12px}
  .roll summary{cursor:pointer;list-style:none;padding:14px 16px;font-weight:600}
  .roll summary::-webkit-details-marker{display:none}
  .roll .row{display:flex;gap:12px;flex-wrap:wrap;color:var(--muted);font-size:13px}
  .tag{border:var(--border);border-radius:999px;padding:2px 8px}
  .pill{border:var(--border);background:#18214a;border-radius:999px;padding:2px 10px}
  @media (max-width:1199px){.frame{grid-template-columns:1fr}.sidebar{display:none}.topnav__inner{grid-template-columns:auto 1fr auto}}
</style>
</head>
<body>
<header class="topnav">
  <div class="topnav__inner">
    <div></div>
    <div class="brand">Fantasy <span>Politics</span></div>
    <div class="nav-actions">
      <button class="btn" onclick="alert('Search coming soon')">Search</button>
      <button class="btn" onclick="alert('Auth coming soon')">Login</button>
    </div>
  </div>
</header>

<div class="app">
  <div class="frame">
    <aside class="sidebar" aria-label="My Team">
      <div class="sidebar__header">
        <div>My Team</div>
        <span class="chip">Synced</span>
      </div>
      <div class="sidebar__scroll" id="teamList">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="chip" id="rosterChip">Roster · 0/10</div>
          <div class="chip">Cap · OK</div>
        </div>
      </div>
    </aside>

    <main class="main" id="main">
      <div class="main__toolbar">
        <div class="toolbar-group">
          <span class="label">View</span>
          <div class="segmented" role="tablist" aria-label="Primary views">
            <button class="active" aria-selected="true" role="tab">Scoreboard</button>
            <button class="disabled" aria-disabled="true" role="tab" title="Cards" onclick="location.href='cards.html'">Cards</button>
            <button class="disabled" aria-disabled="true" role="tab" title="Coming soon">Votes</button>
            <button class="disabled" aria-disabled="true" role="tab" title="Coming soon">Draft</button>
            <button class="disabled" aria-disabled="true" role="tab" title="Coming soon">Rules</button>
          </div>
        </div>
        <div class="toolbar-group">
          <span class="label">Scope</span>
          <div class="segmented" id="scopeTabs" role="tablist" aria-label="Scope">
            <button data-scope="week" class="active" aria-selected="true" role="tab">Week</button>
            <button data-scope="season" role="tab">Season</button>
            <button data-scope="career" role="tab">Career</button>
          </div>
        </div>
        <div class="toolbar-group">
          <span class="label">Filters</span>
          <button class="btn" id="partyBtn">Party</button>
          <button class="btn" id="stateBtn">State</button>
          <button class="btn" id="badgesBtn">Badges</button>
        </div>
        <div class="notice">Votes on this page respect Week or Season. Career hides votes list to avoid heavy loads.</div>
      </div>

      <div class="main__scroll" tabindex="0">
        <section class="section">
          <h2 class="h1">Scoreboard</h2>
          <div class="scorebox">
            <div>
              <div class="big" id="scoreTotal">0</div>
              <div class="muted" id="scoreCaption">Total points · Week</div>
            </div>
          </div>
        </section>

        <section class="section" id="votesSection">
          <h3 class="h1">Votes (Preview)</h3>
          <div class="accordion" id="votesList"></div>
        </section>
      </div>
    </main>
  </div>
</div>

<script>
/* Data contracts:
  /data/scoreboard.json
  {
    "scope":"week|season|career",
    "team":[
      {"id":"A1","name":"Alex Brewer","party":"D","state":"WI","initials":"AB",
       "scores":{"week":128,"season":412,"career":2011}}
    ]
  }

  /data/votes.json
  {
    "week":[
      {"roll":"S.1234","date":"2025-09-18","title":"Continuing Appropriations Act",
       "result":"Passed","yea":78,"nay":20,
       "members":[{"id":"A1","name":"Alex Brewer","vote":"Yea"}]}
    ],
    "season":[ ... ]
  }
*/

const MOCK_SCORE = {
  scope:"week",
  team:[
    {id:"A1",name:"Alex Brewer",party:"D",state:"WI",initials:"AB",scores:{week:128,season:412,career:2011}},
    {id:"B2",name:"Casey Stone",party:"R",state:"TX",initials:"CS",scores:{week:96,season:305,career:1540}},
    {id:"C3",name:"Jordan Moss",party:"I",state:"VT",initials:"JM",scores:{week:77,season:221,career:1204}},
    {id:"D4",name:"Lena Kay",party:"D",state:"CA",initials:"LK",scores:{week:71,season:190,career:1002}},
    {id:"E5",name:"Ray Boone",party:"R",state:"OH",initials:"RB",scores:{week:64,season:178,career:954}}
  ]
};
const MOCK_VOTES = {
  week:[
    {roll:"S.1234",date:"2025-09-18",title:"Continuing Appropriations Act",result:"Passed",yea:78,nay:20,
     members:[{id:"A1",name:"Alex Brewer",vote:"Yea"},{id:"B2",name:"Casey Stone",vote:"Yea"}]},
    {roll:"S.998",date:"2025-09-17",title:"Disaster Relief Supplemental",result:"Agreed to",yea:70,nay:27,
     members:[{id:"C3",name:"Jordan Moss",vote:"Yea"},{id:"D4",name:"Lena Kay",vote:"Nay"}]}
  ],
  season:[]
};

let SCORE = null, VOTES = null, SCOPE = "week";

init();
async function init(){
  SCORE = await loadJSON('data/scoreboard.json', MOCK_SCORE);
  VOTES = await loadJSON('data/votes.json', MOCK_VOTES);
  renderTeam(SCORE.team);
  setScope(SCOPE);
  bindUI();
}

function bindUI(){
  document.getElementById('scopeTabs').addEventListener('click', e=>{
    const btn = e.target.closest('button[data-scope]');
    if(!btn) return;
    SCOPE = btn.dataset.scope;
    [...e.currentTarget.children].forEach(b=>b.classList.toggle('active', b===btn));
    setScope(SCOPE);
  });
  document.getElementById('partyBtn').onclick=()=>alert('Filter coming soon');
  document.getElementById('stateBtn').onclick=()=>alert('Filter coming soon');
  document.getElementById('badgesBtn').onclick=()=>alert('Filter coming soon');
}

function setScope(scope){
  const total = SCORE.team.reduce((s,m)=>s+(m.scores?.[scope]??0),0);
  document.getElementById('scoreTotal').textContent = formatNum(total);
  document.getElementById('scoreCaption').textContent = `Total points · ${cap(scope)}`;
  document.getElementById('votesSection').style.display = scope==="career" ? "none" : "block";
  renderTeam(SCORE.team, scope);
  renderVotes(scope);
}

function renderTeam(team){
  const wrap = document.getElementById('teamList');
  wrap.querySelectorAll('.team-tile').forEach(el=>el.remove());
  team.forEach(m=>{
    const el = document.createElement('div');
    el.className='team-tile';
    el.innerHTML = `
      <div class="avatar">${esc(m.initials||initials(m.name))}</div>
      <div><strong>${esc(m.name)}</strong><div class="muted">${esc(m.party)} · ${esc(m.state)}</div></div>
      <div class="score-badge">+${esc((m.scores?.[SCOPE]??0).toString())}</div>`;
    wrap.appendChild(el);
  });
  document.getElementById('rosterChip').textContent = `Roster · ${team.length}/10`;
}

function renderVotes(scope){
  const list = document.getElementById('votesList');
  list.innerHTML = '';
  const rolls = (VOTES?.[scope]||[]);
  if(!rolls.length){
    const div = document.createElement('div');
    div.className='muted'; div.style.padding='8px';
    div.textContent='No votes available.';
    list.appendChild(div);
    return;
  }
  rolls.forEach(r=>{
    const d = document.createElement('details');
    d.className='roll';
    const head = `
      <summary>
        <div class="row">
          <span class="pill">${esc(r.roll)}</span>
          <span>${esc(r.title)}</span>
        </div>
        <div class="row">
          <span class="tag">${esc(r.result)}</span>
          <span class="muted">${esc(r.date)}</span>
          <span class="muted">Yea ${esc(r.yea||0)} · Nay ${esc(r.nay||0)}</span>
        </div>
      </summary>`;
    const body = `<div style="padding:0 16px 14px 16px">
      ${(r.members||[]).map(m=>`<div class="row"><strong>${esc(m.name)}</strong><span class="tag">${esc(m.vote)}</span></div>`).join('')}
    </div>`;
    d.innerHTML = head + body;
    list.appendChild(d);
  });
}

async function loadJSON(url, fallback){
  try{
    const res = await fetch(url,{cache:'no-store'});
    if(!res.ok) throw new Error('http');
    return await res.json();
  }catch(e){ return fallback; }
}

function formatNum(n){ return new Intl.NumberFormat().format(n); }
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
function initials(name){ return name.split(' ').map(p=>p[0]).slice(0,2).join('').toUpperCase(); }
function esc(s){ return String(s).replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }
</script>
</body>
</html>
